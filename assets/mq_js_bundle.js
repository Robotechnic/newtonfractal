"use strict";const version="0.3.13",canvas=document.querySelector("#glcanvas"),gl=canvas.getContext("webgl2");null===gl&&alert("Unable to initialize WebGL. Your browser or machine may not support it.");var wasm_memory,FS,GL,Module,wasm_exports,emscripten_shaders_hack,importObject,ctx,js_objects,unique_js_id,quad_socket,connected,received_buffer,uid,ongoing_requests,clipboard=null,plugins=[],high_dpi=!1;function assert(e,r){!1==e&&alert(r)}function acquireVertexArrayObjectExtension(e){var r=e.getExtension("OES_vertex_array_object");r&&(e.createVertexArray=function(){return r.createVertexArrayOES()},e.deleteVertexArray=function(e){r.deleteVertexArrayOES(e)},e.bindVertexArray=function(e){r.bindVertexArrayOES(e)},e.isVertexArray=function(e){return r.isVertexArrayOES(e)})}function acquireInstancedArraysExtension(e){var r=e.getExtension("ANGLE_instanced_arrays");r&&(e.vertexAttribDivisor=function(e,t){r.vertexAttribDivisorANGLE(e,t)},e.drawArraysInstanced=function(e,t,n,a){r.drawArraysInstancedANGLE(e,t,n,a)},e.drawElementsInstanced=function(e,t,n,a,o){r.drawElementsInstancedANGLE(e,t,n,a,o)})}function acquireDisjointTimerQueryExtension(e){var r=e.getExtension("EXT_disjoint_timer_query");r&&(e.createQuery=function(){return r.createQueryEXT()},e.beginQuery=function(e,t){return r.beginQueryEXT(e,t)},e.endQuery=function(e){return r.endQueryEXT(e)},e.deleteQuery=function(e){r.deleteQueryEXT(e)},e.getQueryObject=function(e,t){return r.getQueryObjectEXT(e,t)})}function getArray(e,r,t){return new r(wasm_memory.buffer,e,t)}function UTF8ToString(e,r){let t=new Uint8Array(wasm_memory.buffer,e);for(var n,a,o,i,s=0,u=s+r,c="";!(s>=u)&&(n=t[s++]);){if(!(128&n)){c+=String.fromCharCode(n);continue}if(a=63&t[s++],(224&n)==192){c+=String.fromCharCode((31&n)<<6|a);continue}o=63&t[s++],(240&n)==224?n=(15&n)<<12|a<<6|o:((248&n)!=240&&console.warn("Invalid UTF-8 leading byte 0x"+n.toString(16)+" encountered when deserializing a UTF-8 string on the asm.js/wasm heap to a JS string!"),n=(7&n)<<18|a<<12|o<<6|63&t[s++]),n<65536?c+=String.fromCharCode(n):c+=String.fromCharCode(55296|(i=n-65536)>>10,56320|1023&i)}return c}function stringToUTF8(e,r,t,n){for(var a,o,i=t,s=t+n,u=0;u<e.length;++u)if((a=e.charCodeAt(u))>=55296&&a<=57343&&(a=65536+((1023&a)<<10)|1023&(o=e.charCodeAt(++u))),a<=127){if(t>=s)break;r[t++]=a}else if(a<=2047){if(t+1>=s)break;r[t++]=192|a>>6,r[t++]=128|63&a}else if(a<=65535){if(t+2>=s)break;r[t++]=224|a>>12,r[t++]=128|a>>6&63,r[t++]=128|63&a}else{if(t+3>=s)break;a>=2097152&&console.warn("Invalid Unicode code point 0x"+a.toString(16)+" encountered when serializing a JS string to an UTF-8 string on the asm.js/wasm heap! (Valid unicode code points should be in range 0-0x1FFFFF)."),r[t++]=240|a>>18,r[t++]=128|a>>12&63,r[t++]=128|a>>6&63,r[t++]=128|63&a}return t-i}function _glGenObject(e,r,t,n,a){for(var o,i,s=0;s<e;s++)i=(o=gl[t]())&&GL.getNewId(n),o?(o.name=i,n[i]=o):(console.error("GL_INVALID_OPERATION"),GL.recordError(1282),alert("GL_INVALID_OPERATION in "+a+": GLctx."+t+" returned null - most likely GL context is lost!")),getArray(r+4*s,Int32Array,1)[0]=i}function _webglGet(e,r,t){if(!r){console.error("GL_INVALID_VALUE in glGet"+t+"v(name="+e+": Function called with null out pointer!"),GL.recordError(1281);return}var n,a,o,i=void 0;switch(e){case 36346:i=1;break;case 36344:"EM_FUNC_SIG_PARAM_I"!=t&&"EM_FUNC_SIG_PARAM_I64"!=t&&(GL.recordError(1280),err("GL_INVALID_ENUM in glGet"+t+"v(GL_SHADER_BINARY_FORMATS): Invalid parameter type!"));return;case 34814:case 36345:i=0;break;case 34466:i=(a=gl.getParameter(34467))?a.length:0;break;case 33309:case 33307:case 33308:assert(!1,"unimplemented")}if(void 0===i)switch(typeof(n=gl.getParameter(e))){case"number":i=n;break;case"boolean":i=n?1:0;break;case"string":GL.recordError(1280),console.error("GL_INVALID_ENUM in glGet"+t+"v("+e+") on a name which returns a string!");return;case"object":if(null===n)switch(e){case 34964:case 35725:case 34965:case 36006:case 36007:case 32873:case 34229:case 35097:case 36389:case 34068:i=0;break;default:GL.recordError(1280),console.error("GL_INVALID_ENUM in glGet"+t+"v("+e+") and it returns null!");return}else if(n instanceof Float32Array||n instanceof Uint32Array||n instanceof Int32Array||n instanceof Array){for(o=0;o<n.length;++o)assert(!1,"unimplemented");return}else try{i=0|n.name}catch(s){GL.recordError(1280),console.error("GL_INVALID_ENUM in glGet"+t+"v: Unknown object returned from WebGL getParameter("+e+")! (error: "+s+")");return}break;default:GL.recordError(1280),console.error("GL_INVALID_ENUM in glGet"+t+"v: Native code calling glGet"+t+"v("+e+") and it returns "+n+" of type "+typeof n+"!");return}switch(t){case"EM_FUNC_SIG_PARAM_I64":getArray(r,Int32Array,1)[0]=i;case"EM_FUNC_SIG_PARAM_I":getArray(r,Int32Array,1)[0]=i;break;case"EM_FUNC_SIG_PARAM_F":getArray(r,Float32Array,1)[0]=i;break;case"EM_FUNC_SIG_PARAM_B":getArray(r,Int8Array,1)[0]=i?1:0;break;default:throw"internal glGet error, bad type: "+t}}function resize(e,r){var t=dpi_scale(),n=e.clientWidth*t,a=e.clientHeight*t;(e.width!=n||e.height!=a)&&(e.width=n,e.height=a,null!=r&&r(Math.floor(n),Math.floor(a)))}function animation(){wasm_exports.frame(),window.requestAnimationFrame(animation)}canvas.focus(),canvas.requestPointerLock=canvas.requestPointerLock||canvas.mozRequestPointerLock||function(){},document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||function(){},acquireVertexArrayObjectExtension(gl),acquireInstancedArraysExtension(gl),acquireDisjointTimerQueryExtension(gl),gl.getExtension("WEBGL_depth_texture"),FS={loaded_files:[],unique_id:0},GL={counter:1,buffers:[],mappedBuffers:{},programs:[],framebuffers:[],renderbuffers:[],textures:[],uniforms:[],shaders:[],vaos:[],timerQueries:[],contexts:{},programInfos:{},getNewId:function(e){for(var r=GL.counter++,t=e.length;t<r;t++)e[t]=null;return r},validateGLObjectID:function(e,r,t,n){0!=r&&(null===e[r]?console.error(t+" called with an already deleted "+n+" ID "+r+"!"):e[r]||console.error(t+" called with an invalid "+n+" ID "+r+"!"))},getSource:function(e,r,t,n){for(var a,o="",i=0;i<r;++i)a=0==n?void 0:getArray(n+4*i,Uint32Array,1)[0],o+=UTF8ToString(getArray(t+4*i,Uint32Array,1)[0],a);return o},populateUniformTable:function(e){GL.validateGLObjectID(GL.programs,e,"populateUniformTable","program");for(var r,t,n,a,o,i,s=GL.programs[e],u=GL.programInfos[e]={uniforms:{},maxUniformLength:0,maxAttributeLength:-1,maxUniformBlockNameLength:-1},c=u.uniforms,l=gl.getProgramParameter(s,35718),f=0;f<l;++f)if(r=(a=gl.getActiveUniform(s,f)).name,u.maxUniformLength=Math.max(u.maxUniformLength,r.length+1),"]"==r.slice(-1)&&(r=r.slice(0,r.lastIndexOf("["))),t=gl.getUniformLocation(s,r))for(n=GL.getNewId(GL.uniforms),c[r]=[a.size,n],GL.uniforms[n]=t,o=1;o<a.size;++o)i=r+"["+o+"]",t=gl.getUniformLocation(s,i),n=GL.getNewId(GL.uniforms),GL.uniforms[n]=t}};const SAPP_EVENTTYPE_TOUCHES_BEGAN=10,SAPP_EVENTTYPE_TOUCHES_MOVED=11,SAPP_EVENTTYPE_TOUCHES_ENDED=12,SAPP_EVENTTYPE_TOUCHES_CANCELLED=13,SAPP_MODIFIER_SHIFT=1,SAPP_MODIFIER_CTRL=2,SAPP_MODIFIER_ALT=4,SAPP_MODIFIER_SUPER=8;function into_sapp_mousebutton(e){switch(e){case 0:return 0;case 1:return 2;case 2:return 1;default:return e}}function into_sapp_keycode(e){switch(e){case"Space":return 32;case"Quote":return 39;case"Comma":return 44;case"Minus":return 45;case"Period":return 46;case"Slash":return 47;case"Digit0":return 48;case"Digit1":return 49;case"Digit2":return 50;case"Digit3":return 51;case"Digit4":return 52;case"Digit5":return 53;case"Digit6":return 54;case"Digit7":return 55;case"Digit8":return 56;case"Digit9":return 57;case"Semicolon":return 59;case"Equal":return 61;case"KeyA":return 65;case"KeyB":return 66;case"KeyC":return 67;case"KeyD":return 68;case"KeyE":return 69;case"KeyF":return 70;case"KeyG":return 71;case"KeyH":return 72;case"KeyI":return 73;case"KeyJ":return 74;case"KeyK":return 75;case"KeyL":return 76;case"KeyM":return 77;case"KeyN":return 78;case"KeyO":return 79;case"KeyP":return 80;case"KeyQ":return 81;case"KeyR":return 82;case"KeyS":return 83;case"KeyT":return 84;case"KeyU":return 85;case"KeyV":return 86;case"KeyW":return 87;case"KeyX":return 88;case"KeyY":return 89;case"KeyZ":return 90;case"BracketLeft":return 91;case"Backslash":return 92;case"BracketRight":return 93;case"Backquote":return 96;case"Escape":return 256;case"Enter":return 257;case"Tab":return 258;case"Backspace":return 259;case"Insert":return 260;case"Delete":return 261;case"ArrowRight":return 262;case"ArrowLeft":return 263;case"ArrowDown":return 264;case"ArrowUp":return 265;case"PageUp":return 266;case"PageDown":return 267;case"Home":return 268;case"End":return 269;case"CapsLock":return 280;case"ScrollLock":return 281;case"NumLock":return 282;case"PrintScreen":return 283;case"Pause":return 284;case"F1":return 290;case"F2":return 291;case"F3":return 292;case"F4":return 293;case"F5":return 294;case"F6":return 295;case"F7":return 296;case"F8":return 297;case"F9":return 298;case"F10":return 299;case"F11":return 300;case"F12":return 301;case"F13":return 302;case"F14":return 303;case"F15":return 304;case"F16":return 305;case"F17":return 306;case"F18":return 307;case"F19":return 308;case"F20":return 309;case"F21":return 310;case"F22":return 311;case"F23":return 312;case"F24":return 313;case"Numpad0":return 320;case"Numpad1":return 321;case"Numpad2":return 322;case"Numpad3":return 323;case"Numpad4":return 324;case"Numpad5":return 325;case"Numpad6":return 326;case"Numpad7":return 327;case"Numpad8":return 328;case"Numpad9":return 329;case"NumpadDecimal":return 330;case"NumpadDivide":return 331;case"NumpadMultiply":return 332;case"NumpadSubtract":return 333;case"NumpadAdd":return 334;case"NumpadEnter":return 335;case"NumpadEqual":return 336;case"ShiftLeft":return 340;case"ControlLeft":return 341;case"AltLeft":return 342;case"OSLeft":return 343;case"ShiftRight":return 344;case"ControlRight":return 345;case"AltRight":return 346;case"OSRight":return 347;case"ContextMenu":return 348}console.log("Unsupported keyboard key: ",e)}function dpi_scale(){return high_dpi&&window.devicePixelRatio||1}function texture_size(e,r,t){return e==gl.ALPHA?r*t:e==gl.RGB?r*t*3:e==gl.RGBA?r*t*4:r*t*3}function mouse_relative_position(e,r){var t=canvas.getBoundingClientRect(),n=(e-t.left)*dpi_scale(),a=(r-t.top)*dpi_scale();return{x:n,y:a}}function register_plugins(e){if(null!=e)for(var r=0;r<e.length;r++)void 0!=e[r].register_plugin&&null!=e[r].register_plugin&&e[r].register_plugin(importObject)}function u32_to_semver(e){return(e>>24&255)+"."+(e>>16&255)+"."+(65535&e)}function init_plugins(e){if(null!=e)for(var r,t,n=0;n<e.length;n++)void 0!=e[n].on_init&&null!=e[n].on_init&&e[n].on_init(),void 0==e[n].name||null==e[n].name||void 0==e[n].version||null==e[n].version?(console.warn("Some of the registred plugins do not have name or version"),console.warn("Probably old version of the plugin used")):void 0==wasm_exports[r=e[n].name+"_crate_version"]?console.log("Plugin "+e[n].name+" is present in JS bundle, but is not used in the rust code."):(t=u32_to_semver(wasm_exports[r]()),e[n].version!=t&&console.error("Plugin "+e[n].name+" version mismatchjs version: "+e[n].version+", crate version: "+t))}function miniquad_add_plugin(e){plugins.push(e)}function add_missing_functions_stabs(e){var r=WebAssembly.Module.imports(e);for(let t in r)void 0==importObject.env[r[t].name]&&(console.warn("No "+r[t].name+" function in gl.js"),importObject.env[r[t].name]=function(){console.warn("Missed function: "+r[t].name)})}function load(e){var r=fetch(e);register_plugins(plugins),"function"==typeof WebAssembly.compileStreaming?WebAssembly.compileStreaming(r).then(e=>(add_missing_functions_stabs(e),WebAssembly.instantiate(e,importObject))).then(e=>{wasm_memory=e.exports.memory;var r=u32_to_semver((wasm_exports=e.exports).crate_version());version!=r&&console.error("Version mismatch: gl.js version is: "+version+", rust sapp-wasm crate version is: "+r),init_plugins(plugins),e.exports.main()}).catch(e=>{console.error("WASM failed to load, probably incompatible gl.js version"),console.error(e)}):r.then(function(e){return e.arrayBuffer()}).then(function(e){return WebAssembly.compile(e)}).then(function(e){return add_missing_functions_stabs(e),WebAssembly.instantiate(e,importObject)}).then(function(e){wasm_memory=e.exports.memory;var r=u32_to_semver((wasm_exports=e.exports).crate_version());version!=r&&console.error("Version mismatch: gl.js version is: "+version+", rust sapp-wasm crate version is: "+r),init_plugins(plugins),e.exports.main()}).catch(e=>{console.error("WASM failed to load, probably incompatible gl.js version"),console.error(e)})}emscripten_shaders_hack=!1,importObject={env:{console_debug:function(e){console.debug(UTF8ToString(e))},console_log:function(e){console.log(UTF8ToString(e))},console_info:function(e){console.info(UTF8ToString(e))},console_warn:function(e){console.warn(UTF8ToString(e))},console_error:function(e){console.error(UTF8ToString(e))},set_emscripten_shader_hack:function(e){emscripten_shaders_hack=e},sapp_set_clipboard:function(e,r){clipboard=UTF8ToString(e,r)},dpi_scale,rand:function(){return Math.floor(2147483647*Math.random())},now:function(){return Date.now()/1e3},canvas_width:function(){return Math.floor(canvas.width)},canvas_height:function(){return Math.floor(canvas.height)},glClearDepthf:function(e){gl.clearDepth(e)},glClearColor:function(e,r,t,n){gl.clearColor(e,r,t,n)},glClearStencil:function(e){gl.clearColorStencil(e)},glColorMask:function(e,r,t,n){gl.colorMask(e,r,t,n)},glScissor:function(e,r,t,n){gl.scissor(e,r,t,n)},glClear:function(e){gl.clear(e)},glGenTextures:function(e,r){_glGenObject(e,r,"createTexture",GL.textures,"glGenTextures")},glActiveTexture:function(e){gl.activeTexture(e)},glBindTexture:function(e,r){GL.validateGLObjectID(GL.textures,r,"glBindTexture","texture"),gl.bindTexture(e,GL.textures[r])},glTexImage2D:function(e,r,t,n,a,o,i,s,u){gl.texImage2D(e,r,t,n,a,o,i,s,u?getArray(u,Uint8Array,texture_size(t,n,a)):null)},glTexSubImage2D:function(e,r,t,n,a,o,i,s,u){gl.texSubImage2D(e,r,t,n,a,o,i,s,u?getArray(u,Uint8Array,texture_size(i,a,o)):null)},glReadPixels:function(e,r,t,n,a,o,i){var s=getArray(i,Uint8Array,texture_size(a,t,n));gl.readPixels(e,r,t,n,a,o,s)},glTexParameteri:function(e,r,t){gl.texParameteri(e,r,t)},glUniform1fv:function(e,r,t){GL.validateGLObjectID(GL.uniforms,e,"glUniform1fv","location"),assert((3&t)==0,"Pointer to float data passed to glUniform1fv must be aligned to four bytes!");var n=getArray(t,Float32Array,1*r);gl.uniform1fv(GL.uniforms[e],n)},glUniform2fv:function(e,r,t){GL.validateGLObjectID(GL.uniforms,e,"glUniform2fv","location"),assert((3&t)==0,"Pointer to float data passed to glUniform2fv must be aligned to four bytes!");var n=getArray(t,Float32Array,2*r);gl.uniform2fv(GL.uniforms[e],n)},glUniform3fv:function(e,r,t){GL.validateGLObjectID(GL.uniforms,e,"glUniform3fv","location"),assert((3&t)==0,"Pointer to float data passed to glUniform3fv must be aligned to four bytes!");var n=getArray(t,Float32Array,3*r);gl.uniform3fv(GL.uniforms[e],n)},glUniform4fv:function(e,r,t){GL.validateGLObjectID(GL.uniforms,e,"glUniform4fv","location"),assert((3&t)==0,"Pointer to float data passed to glUniform4fv must be aligned to four bytes!");var n=getArray(t,Float32Array,4*r);gl.uniform4fv(GL.uniforms[e],n)},glUniform1iv:function(e,r,t){GL.validateGLObjectID(GL.uniforms,e,"glUniform1fv","location"),assert((3&t)==0,"Pointer to i32 data passed to glUniform1iv must be aligned to four bytes!");var n=getArray(t,Int32Array,1*r);gl.uniform1iv(GL.uniforms[e],n)},glUniform2iv:function(e,r,t){GL.validateGLObjectID(GL.uniforms,e,"glUniform2fv","location"),assert((3&t)==0,"Pointer to i32 data passed to glUniform2iv must be aligned to four bytes!");var n=getArray(t,Int32Array,2*r);gl.uniform2iv(GL.uniforms[e],n)},glUniform3iv:function(e,r,t){GL.validateGLObjectID(GL.uniforms,e,"glUniform3fv","location"),assert((3&t)==0,"Pointer to i32 data passed to glUniform3iv must be aligned to four bytes!");var n=getArray(t,Int32Array,3*r);gl.uniform3iv(GL.uniforms[e],n)},glUniform4iv:function(e,r,t){GL.validateGLObjectID(GL.uniforms,e,"glUniform4fv","location"),assert((3&t)==0,"Pointer to i32 data passed to glUniform4iv must be aligned to four bytes!");var n=getArray(t,Int32Array,4*r);gl.uniform4iv(GL.uniforms[e],n)},glBlendFunc:function(e,r){gl.blendFunc(e,r)},glBlendEquationSeparate:function(e,r){gl.blendEquationSeparate(e,r)},glDisable:function(e){gl.disable(e)},glDrawElements:function(e,r,t,n){gl.drawElements(e,r,t,n)},glGetIntegerv:function(e,r){_webglGet(e,r,"EM_FUNC_SIG_PARAM_I")},glUniform1f:function(e,r){GL.validateGLObjectID(GL.uniforms,e,"glUniform1f","location"),gl.uniform1f(GL.uniforms[e],r)},glUniform1i:function(e,r){GL.validateGLObjectID(GL.uniforms,e,"glUniform1i","location"),gl.uniform1i(GL.uniforms[e],r)},glGetAttribLocation:function(e,r){return gl.getAttribLocation(GL.programs[e],UTF8ToString(r))},glEnableVertexAttribArray:function(e){gl.enableVertexAttribArray(e)},glDisableVertexAttribArray:function(e){gl.disableVertexAttribArray(e)},glVertexAttribPointer:function(e,r,t,n,a,o){gl.vertexAttribPointer(e,r,t,!!n,a,o)},glGetUniformLocation:function(e,r){GL.validateGLObjectID(GL.programs,e,"glGetUniformLocation","program");var t,n,a=0;return"]"==(r=UTF8ToString(r))[r.length-1]&&(a="]"!=r[(t=r.lastIndexOf("["))+1]?parseInt(r.slice(t+1)):0,r=r.slice(0,t)),(n=GL.programInfos[e]&&GL.programInfos[e].uniforms[r])&&a>=0&&a<n[0]?n[1]+a:-1},glUniformMatrix4fv:function(e,r,t,n){GL.validateGLObjectID(GL.uniforms,e,"glUniformMatrix4fv","location"),assert((3&n)==0,"Pointer to float data passed to glUniformMatrix4fv must be aligned to four bytes!");var a=getArray(n,Float32Array,16);gl.uniformMatrix4fv(GL.uniforms[e],!!t,a)},glUseProgram:function(e){GL.validateGLObjectID(GL.programs,e,"glUseProgram","program"),gl.useProgram(GL.programs[e])},glGenVertexArrays:function(e,r){_glGenObject(e,r,"createVertexArray",GL.vaos,"glGenVertexArrays")},glGenFramebuffers:function(e,r){_glGenObject(e,r,"createFramebuffer",GL.framebuffers,"glGenFramebuffers")},glBindVertexArray:function(e){gl.bindVertexArray(GL.vaos[e])},glBindFramebuffer:function(e,r){GL.validateGLObjectID(GL.framebuffers,r,"glBindFramebuffer","framebuffer"),gl.bindFramebuffer(e,GL.framebuffers[r])},glGenBuffers:function(e,r){_glGenObject(e,r,"createBuffer",GL.buffers,"glGenBuffers")},glBindBuffer:function(e,r){GL.validateGLObjectID(GL.buffers,r,"glBindBuffer","buffer"),gl.bindBuffer(e,GL.buffers[r])},glBufferData:function(e,r,t,n){gl.bufferData(e,t?getArray(t,Uint8Array,r):r,n)},glBufferSubData:function(e,r,t,n){gl.bufferSubData(e,r,n?getArray(n,Uint8Array,t):t)},glEnable:function(e){gl.enable(e)},glFlush:function(){gl.flush()},glFinish:function(){gl.finish()},glDepthFunc:function(e){gl.depthFunc(e)},glBlendFuncSeparate:function(e,r,t,n){gl.blendFuncSeparate(e,r,t,n)},glViewport:function(e,r,t,n){gl.viewport(e,r,t,n)},glDrawArrays:function(e,r,t){gl.drawArrays(e,r,t)},glCreateProgram:function(){var e=GL.getNewId(GL.programs),r=gl.createProgram();return r.name=e,GL.programs[e]=r,e},glAttachShader:function(e,r){GL.validateGLObjectID(GL.programs,e,"glAttachShader","program"),GL.validateGLObjectID(GL.shaders,r,"glAttachShader","shader"),gl.attachShader(GL.programs[e],GL.shaders[r])},glLinkProgram:function(e){GL.validateGLObjectID(GL.programs,e,"glLinkProgram","program"),gl.linkProgram(GL.programs[e]),GL.populateUniformTable(e)},glPixelStorei:function(e,r){gl.pixelStorei(e,r)},glFramebufferTexture2D:function(e,r,t,n,a){GL.validateGLObjectID(GL.textures,n,"glFramebufferTexture2D","texture"),gl.framebufferTexture2D(e,r,t,GL.textures[n],a)},glGetProgramiv:function(e,r,t){var n;if(assert(t),GL.validateGLObjectID(GL.programs,e,"glGetProgramiv","program"),e>=GL.counter){console.error("GL_INVALID_VALUE in glGetProgramiv");return}if(!GL.programInfos[e]){console.error("GL_INVALID_OPERATION in glGetProgramiv(program="+e+", pname="+r+", p=0x"+t.toString(16)+"): The specified GL object name does not refer to a program object!");return}if(35716==r)assert(null!==(n=gl.getProgramInfoLog(GL.programs[e]))),getArray(t,Int32Array,1)[0]=n.length+1;else if(35719==r){console.error("unsupported operation");return}else if(35722==r){console.error("unsupported operation");return}else if(35381==r){console.error("unsupported operation");return}else getArray(t,Int32Array,1)[0]=gl.getProgramParameter(GL.programs[e],r)},glCreateShader:function(e){var r=GL.getNewId(GL.shaders);return GL.shaders[r]=gl.createShader(e),r},glStencilFuncSeparate:function(e,r,t,n){gl.stencilFuncSeparate(e,r,t,n)},glStencilMaskSeparate:function(e,r){gl.stencilMaskSeparate(e,r)},glStencilOpSeparate:function(e,r,t,n){gl.stencilOpSeparate(e,r,t,n)},glFrontFace:function(e){gl.frontFace(e)},glCullFace:function(e){gl.cullFace(e)},glCopyTexImage2D:function(e,r,t,n,a,o,i,s){gl.copyTexImage2D(e,r,t,n,a,o,i,s)},glShaderSource:function(e,r,t,n){GL.validateGLObjectID(GL.shaders,e,"glShaderSource","shader");var a,o=GL.getSource(e,r,t,n);emscripten_shaders_hack&&(o=(o=o.replace(/#extension GL_OES_standard_derivatives : enable/g,"")).replace(/#extension GL_EXT_shader_texture_lod : enable/g,""),a="",-1!=o.indexOf("gl_FragColor")&&(a+=`out mediump vec4 GL_FragColor;
`,o=o.replace(/gl_FragColor/g,"GL_FragColor")),o=(o=(o=(o=(o=(o=(o=(o=(o=(o=(o=(o=-1!=o.indexOf("attribute")?(o=o.replace(/attribute/g,"in")).replace(/varying/g,"out"):o.replace(/varying/g,"in")).replace(/textureCubeLodEXT/g,"textureCubeLod")).replace(/texture2DLodEXT/g,"texture2DLod")).replace(/texture2DProjLodEXT/g,"texture2DProjLod")).replace(/texture2DGradEXT/g,"texture2DGrad")).replace(/texture2DProjGradEXT/g,"texture2DProjGrad")).replace(/textureCubeGradEXT/g,"textureCubeGrad")).replace(/textureCube/g,"texture")).replace(/texture1D/g,"texture")).replace(/texture2D/g,"texture")).replace(/texture3D/g,"texture")).replace(/#version 100/g,`#version 300 es
`+a)),gl.shaderSource(GL.shaders[e],o)},glGetProgramInfoLog:function(e,r,t,n){GL.validateGLObjectID(GL.programs,e,"glGetProgramInfoLog","program");var a,o=gl.getProgramInfoLog(GL.programs[e]);assert(null!==o);let i=getArray(n,Uint8Array,r);for(a=0;a<r;a++)i[a]=o.charCodeAt(a)},glCompileShader:function(e){GL.validateGLObjectID(GL.shaders,e,"glCompileShader","shader"),gl.compileShader(GL.shaders[e])},glGetShaderiv:function(e,r,t){if(assert(t),GL.validateGLObjectID(GL.shaders,e,"glGetShaderiv","shader"),35716==r){var n,a,o=gl.getShaderInfoLog(GL.shaders[e]);assert(null!==o),getArray(t,Int32Array,1)[0]=o.length+1}else 35720==r?(a=null===(n=gl.getShaderSource(GL.shaders[e]))||0==n.length?0:n.length+1,getArray(t,Int32Array,1)[0]=a):getArray(t,Int32Array,1)[0]=gl.getShaderParameter(GL.shaders[e],r)},glGetShaderInfoLog:function(e,r,t,n){GL.validateGLObjectID(GL.shaders,e,"glGetShaderInfoLog","shader");var a,o=gl.getShaderInfoLog(GL.shaders[e]);assert(null!==o);let i=getArray(n,Uint8Array,r);for(a=0;a<r;a++)i[a]=o.charCodeAt(a)},glVertexAttribDivisor:function(e,r){gl.vertexAttribDivisor(e,r)},glDrawArraysInstanced:function(e,r,t,n){gl.drawArraysInstanced(e,r,t,n)},glDrawElementsInstanced:function(e,r,t,n,a){gl.drawElementsInstanced(e,r,t,n,a)},glDeleteShader:function(e){gl.deleteShader(e)},glDeleteBuffers:function(e,r){for(var t,n,a=0;a<e;a++)n=getArray(r+4*a,Uint32Array,1)[0],(t=GL.buffers[n])&&(gl.deleteBuffer(t),t.name=0,GL.buffers[n]=null)},glDeleteFramebuffers:function(e,r){for(var t,n,a=0;a<e;a++)n=getArray(r+4*a,Uint32Array,1)[0],(t=GL.framebuffers[n])&&(gl.deleteFramebuffer(t),t.name=0,GL.framebuffers[n]=null)},glDeleteTextures:function(e,r){for(var t,n,a=0;a<e;a++)n=getArray(r+4*a,Uint32Array,1)[0],(t=GL.textures[n])&&(gl.deleteTexture(t),t.name=0,GL.textures[n]=null)},glGenQueries:function(e,r){_glGenObject(e,r,"createQuery",GL.timerQueries,"glGenQueries")},glDeleteQueries:function(e){for(var r,t,n=0;n<e;n++)t=getArray(textures+4*n,Uint32Array,1)[0],(r=GL.timerQueries[t])&&(gl.deleteQuery(r),r.name=0,GL.timerQueries[t]=null)},glBeginQuery:function(e,r){GL.validateGLObjectID(GL.timerQueries,r,"glBeginQuery","id"),gl.beginQuery(e,GL.timerQueries[r])},glEndQuery:function(e){gl.endQuery(e)},glGetQueryObjectiv:function(e,r,t){GL.validateGLObjectID(GL.timerQueries,e,"glGetQueryObjectiv","id");let n=gl.getQueryObject(GL.timerQueries[e],r);getArray(t,Uint32Array,1)[0]=n},glGetQueryObjectui64v:function(e,r,t){GL.validateGLObjectID(GL.timerQueries,e,"glGetQueryObjectui64v","id");let n=gl.getQueryObject(GL.timerQueries[e],r),a=getArray(t,Uint32Array,2);a[0]=n,a[1]=(n-a[0])/4294967296},setup_canvas_size:function(e){window.high_dpi=e,resize(canvas)},run_animation_loop:function(){canvas.onmousemove=function(e){var r=mouse_relative_position(e.clientX,e.clientY),t=r.x,n=r.y;wasm_exports.mouse_move(Math.floor(t),Math.floor(n)),(0!=e.movementX||0!=e.movementY)&&wasm_exports.raw_mouse_move(Math.floor(e.movementX),Math.floor(e.movementY))},canvas.onmousedown=function(e){var r=mouse_relative_position(e.clientX,e.clientY),t=r.x,n=r.y,a=into_sapp_mousebutton(e.button);wasm_exports.mouse_down(t,n,a)},canvas.addEventListener("wheel",function(e){e.preventDefault(),wasm_exports.mouse_wheel(-e.deltaX,-e.deltaY)}),canvas.onmouseup=function(e){var r=mouse_relative_position(e.clientX,e.clientY),t=r.x,n=r.y,a=into_sapp_mousebutton(e.button);wasm_exports.mouse_up(t,n,a)},canvas.onkeydown=function(e){var r,t=into_sapp_keycode(e.code);switch(t){case 32:case 262:case 263:case 264:case 265:case 290:case 291:case 292:case 293:case 294:case 295:case 296:case 297:case 298:case 299:case 259:case 258:case 39:case 47:e.preventDefault()}r=0,e.ctrlKey&&(r|=2),e.shiftKey&&(r|=1),e.altKey&&(r|=4),wasm_exports.key_down(t,r,e.repeat),(32==t||39==t||47==t)&&wasm_exports.key_press(t)},canvas.onkeyup=function(e){var r=into_sapp_keycode(e.code),t=0;e.ctrlKey&&(t|=2),e.shiftKey&&(t|=1),e.altKey&&(t|=4),wasm_exports.key_up(r,t)},canvas.onkeypress=function(e){!1==(261==into_sapp_keycode(e.code)||e.ctrlKey)&&wasm_exports.key_press(e.charCode)},canvas.addEventListener("touchstart",function(e){for(let r of(e.preventDefault(),e.changedTouches)){let t=mouse_relative_position(r.clientX,r.clientY);wasm_exports.touch(10,r.identifier,t.x,t.y)}}),canvas.addEventListener("touchend",function(e){for(let r of(e.preventDefault(),e.changedTouches)){let t=mouse_relative_position(r.clientX,r.clientY);wasm_exports.touch(12,r.identifier,t.x,t.y)}}),canvas.addEventListener("touchcancel",function(e){for(let r of(e.preventDefault(),e.changedTouches)){let t=mouse_relative_position(r.clientX,r.clientY);wasm_exports.touch(SAPP_EVENTTYPE_TOUCHES_CANCELED,r.identifier,t.x,t.y)}}),canvas.addEventListener("touchmove",function(e){for(let r of(e.preventDefault(),e.changedTouches)){let t=mouse_relative_position(r.clientX,r.clientY);wasm_exports.touch(11,r.identifier,t.x,t.y)}}),window.onresize=function(){resize(canvas,wasm_exports.resize)},window.addEventListener("copy",function(){null!=clipboard&&(event.clipboardData.setData("text/plain",clipboard),event.preventDefault())}),window.addEventListener("cut",function(){null!=clipboard&&(event.clipboardData.setData("text/plain",clipboard),event.preventDefault())}),window.addEventListener("paste",function(e){e.stopPropagation(),e.preventDefault();var r,t,n,a=(e.clipboardData||window.clipboardData).getData("Text");null!=a&&0!=a.length&&(r=(new TextEncoder).encode(a).length,t=wasm_exports.allocate_vec_u8(r),stringToUTF8(a,n=new Uint8Array(wasm_memory.buffer,t,r),0,r),wasm_exports.on_clipboard_paste(t,r))}),window.ondragover=function(e){e.preventDefault()},window.ondrop=async function(e){for(let r of(e.preventDefault(),wasm_exports.on_files_dropped_start(),e.dataTransfer.files)){let t=r.name.length,n=wasm_exports.allocate_vec_u8(t),a=new Uint8Array(wasm_memory.buffer,n,t);stringToUTF8(r.name,a,0,t);let o=await r.arrayBuffer(),i=o.byteLength,s=wasm_exports.allocate_vec_u8(i),u=new Uint8Array(wasm_memory.buffer,s,i);u.set(new Uint8Array(o),0),wasm_exports.on_file_dropped(n,t,s,i)}wasm_exports.on_files_dropped_finish()},window.requestAnimationFrame(animation)},fs_load_file:function(e,r){var t,n=UTF8ToString(e,r),a=FS.unique_id;return FS.unique_id+=1,(t=new XMLHttpRequest).open("GET",n,!0),t.responseType="arraybuffer",t.onload=function(){if(200==this.status){var e=new Uint8Array(this.response);FS.loaded_files[a]=e,wasm_exports.file_loaded(a)}},t.onerror=function(){FS.loaded_files[a]=null,wasm_exports.file_loaded(a)},t.send(),a},fs_get_buffer_size:function(e){return null==FS.loaded_files[e]?-1:FS.loaded_files[e].length},fs_take_buffer:function(e,r,t){var n,a,o=FS.loaded_files[e];for(console.assert(o.length<=t),a=new Uint8Array(wasm_memory.buffer,r,t),n=0;n<o.length;n++)a[n]=o[n];delete FS.loaded_files[e]},sapp_set_cursor_grab:function(e){e?canvas.requestPointerLock():document.exitPointerLock()},sapp_set_cursor:function(e,r){canvas.style.cursor=UTF8ToString(e,r)},sapp_is_fullscreen:function(){let e=document.fullscreenElement;return null!=e&&e.id==canvas.id},sapp_set_fullscreen:function(e){e?canvas.requestFullscreen():document.exitFullscreen()},sapp_set_window_size:function(e,r){canvas.width=e,canvas.height=r,resize(canvas,wasm_exports.resize)}}};const AudioContext=window.AudioContext||window.webkitAudioContext;let audio_context,sounds=new Map,playbacks=[],sound_key_next=1,playback_key_next=1;function audio_init(){if(null==audio_context){(audio_context=new AudioContext).listener;{let e=new(window.AudioContext||window.webkitAudioContext);var r=function(){console.log("fix"),audio_context.resume();var t=e.createBuffer(1,1,22050),n=e.createBufferSource();n.buffer=t,n.connect(e.destination),n.start?n.start(0):n.play?n.play(0):n.noteOn&&n.noteOn(0),document.removeEventListener("touchstart",r),document.removeEventListener("touchend",r),document.removeEventListener("mousedown",r),document.removeEventListener("keydown",r)};document.addEventListener("touchstart",r),document.addEventListener("touchend",r),document.addEventListener("mousedown",r),document.addEventListener("keydown",r)}}}function audio_add_buffer(e,r){let t=wasm_memory.buffer.slice(e,e+r),n=sound_key_next;return sound_key_next+=1,audio_context.decodeAudioData(t,function(e){sounds.set(n,e)},function(e){console.error("Failed to decode audio buffer",e)}),n}function audio_source_is_loaded(e){return sounds.has(e)&&void 0!=sounds.get(e)}function recycle_playback(){let e=playbacks.find(e=>0===e.sound_key);return null!=e?e.source=audio_context.createBufferSource():(e={sound_key:0,playback_key:0,source:audio_context.createBufferSource(),gain_node:audio_context.createGain(),ended:null},playbacks.push(e)),e}function stop(e){try{e.source.removeEventListener("ended",e.ended),e.source.disconnect(),e.gain_node.disconnect(),e.sound_key=0,e.playback_key=0}catch(r){console.error("Error stopping sound",r)}}function audio_play_buffer(e,r,t){let n=playback_key_next++,a=recycle_playback();a.sound_key=e,a.playback_key=n,a.source.connect(a.gain_node),a.gain_node.connect(audio_context.destination),a.gain_node.gain.value=r,a.source.loop=t,a.ended=function(){stop(a)},a.source.addEventListener("ended",a.ended);try{a.source.buffer=sounds.get(e),a.source.start(0)}catch(o){console.error("Error starting sound",o)}return n}function audio_source_set_volume(e,r){playbacks.forEach(t=>{t.sound_key===e&&(t.gain_node.gain.value=r)})}function audio_source_stop(e){playbacks.forEach(r=>{r.sound_key===e&&stop(r)})}function audio_source_delete(e){audio_source_stop(e),sounds.delete(e)}function audio_playback_stop(e){let r=playbacks.find(r=>r.playback_key===e);null!=r&&stop(r)}function audio_playback_set_volume(e,r){let t=playbacks.find(r=>r.playback_key===e);null!=t&&(t.gain_node.gain.value=r)}function register_plugin(e){e.env.audio_init=audio_init,e.env.audio_add_buffer=audio_add_buffer,e.env.audio_play_buffer=audio_play_buffer,e.env.audio_source_is_loaded=audio_source_is_loaded,e.env.audio_source_set_volume=audio_source_set_volume,e.env.audio_source_stop=audio_source_stop,e.env.audio_source_delete=audio_source_delete,e.env.audio_playback_stop=audio_playback_stop,e.env.audio_playback_set_volume=audio_playback_set_volume}function toUTF8Array(e){for(var r,t=[],n=0;n<e.length;n++)(r=e.charCodeAt(n))<128?t.push(r):r<2048?t.push(192|r>>6,128|63&r):r<55296||r>=57344?t.push(224|r>>12,128|r>>6&63,128|63&r):(n++,t.push(240|(r=65536+((1023&r)<<10|1023&e.charCodeAt(n)))>>18,128|r>>12&63,128|r>>6&63,128|63&r));return t}function js_object(e){if(null==e)return -2;if(null===e)return -1;var r=unique_js_id;return js_objects[r]=e,unique_js_id+=1,r}function consume_js_object(e){var r=js_objects[e];return delete js_objects[e],r}function get_js_object(e){return js_objects[e]}function on_init(){}function ws_is_connected(){return connected}function ws_connect(e){(quad_socket=new WebSocket(consume_js_object(e))).binaryType="arraybuffer",quad_socket.onopen=function(){connected=1},quad_socket.onmessage=function(e){if("string"==typeof e.data)received_buffer.push({text:1,data:e.data});else{var r=new Uint8Array(e.data);received_buffer.push({text:0,data:r})}}}function ws_send(e){var r=consume_js_object(e);void 0!=r.buffer?quad_socket.send(r.buffer):quad_socket.send(r)}function ws_try_recv(){return 0!=received_buffer.length?js_object(received_buffer.shift()):-1}function http_try_recv(e){if(void 0!=ongoing_requests[e]&&null!=ongoing_requests[e]){var r=ongoing_requests[e];return ongoing_requests[e]=null,js_object(r)}return -1}function http_make_request(e,r,t,n){var a,o,i,s,u,c=uid;for(let l in uid+=1,0==e&&(o="POST"),1==e&&(o="PUT"),2==e&&(o="GET"),3==e&&(o="DELETE"),s=consume_js_object(r),u=consume_js_object(t),i=consume_js_object(n),(a=new XMLHttpRequest).open(o,s,!0),a.responseType="arraybuffer",i)a.setRequestHeader(l,i[l]);return a.onload=function(){if(200==this.status){var e=new Uint8Array(this.response);ongoing_requests[c]=e}},a.onerror=function(e){console.error("Failed to make a request"),console.error(e)},a.send(u),c}miniquad_add_plugin({register_plugin,version:"0.1.0",name:"macroquad_audio"}),ctx=null,(js_objects={})[-1]=null,js_objects[-2]=void 0,unique_js_id=0,register_plugin=function(e){e.env.js_create_string=function(e,r){var t=UTF8ToString(e,r);return js_object(t)},e.env.js_create_buffer=function(e,r){var t=new Uint8Array(wasm_memory.buffer,e,r),n=new Uint8Array(new ArrayBuffer(t.byteLength));return n.set(new Uint8Array(t)),js_object(n)},e.env.js_create_object=function(){return js_object({})},e.env.js_set_field_f32=function(e,r,t,n){var a=UTF8ToString(r,t);js_objects[e][a]=n},e.env.js_set_field_u32=function(e,r,t,n){var a=UTF8ToString(r,t);js_objects[e][a]=n},e.env.js_set_field_string=function(e,r,t,n,a){var o=UTF8ToString(r,t),i=UTF8ToString(n,a);js_objects[e][o]=i},e.env.js_unwrap_to_str=function(e,r,t){for(var n=js_objects[e],a=toUTF8Array(n),o=a.length,i=new Uint8Array(wasm_memory.buffer,r,t),s=0;s<o;s++)i[s]=a[s]},e.env.js_unwrap_to_buf=function(e,r,t){for(var n=js_objects[e],a=n.length,o=new Uint8Array(wasm_memory.buffer,r,t),i=0;i<a;i++)o[i]=n[i]},e.env.js_string_length=function(e){return toUTF8Array(js_objects[e]).length},e.env.js_buf_length=function(e){return js_objects[e].length},e.env.js_free_object=function(e){delete js_objects[e]},e.env.js_have_field=function(e,r,t){var n=UTF8ToString(r,t);return void 0!==js_objects[e][n]},e.env.js_field_f32=function(e,r,t){var n=UTF8ToString(r,t);return js_objects[e][n]},e.env.js_field_u32=function(e,r,t){var n=UTF8ToString(r,t);return js_objects[e][n]},e.env.js_field=function(e,r,t){var n=UTF8ToString(r,t);return js_object(js_objects[e][n])},e.env.js_field_num=function(e,r,t){var n=UTF8ToString(r,t);return js_objects[e][n]}},miniquad_add_plugin({register_plugin,version:"0.1.5",name:"sapp_jsutils"}),register_plugin=function(e){e.env.ws_connect=ws_connect,e.env.ws_is_connected=ws_is_connected,e.env.ws_send=ws_send,e.env.ws_try_recv=ws_try_recv,e.env.http_make_request=http_make_request,e.env.http_try_recv=http_try_recv},miniquad_add_plugin({register_plugin,on_init,version:"0.1.1",name:"quad_net"}),connected=0,received_buffer=[],uid=0,ongoing_requests={};